 : JF-HERE HERE ;
 : JF-CREATE CREATE ;
 : JF-FIND FIND ;
 : JF-WORD WORD ;
 : HERE JF-HERE @ ;
 : ALLOT HERE + JF-HERE ! ;
 : ['] ' LIT , ;
 IMMEDIATE : ' JF-WORD JF-FIND >CFA ;
 : CELL+ 4 + ;
 : ALIGNED 3 + 3 INVERT AND ;
 : ALIGN JF-HERE @ ALIGNED JF-HERE ! ;
 : CREATE JF-WORD JF-CREATE DOCREATE , ;
 : (DODOES-INT) ALIGN JF-HERE @ LATEST @ >CFA ! DODOES> ['] LIT , LATEST @ >DFA , ;
 : (DODOES-COMP) (DODOES-INT) ['] LIT , , ['] FIP! , ;
 : DOES>COMP ['] LIT , HERE 3 CELLS + , ['] (DODOES-COMP) , ['] EXIT , ;
 : DOES>INT (DODOES-INT) LATEST @ HIDDEN ] ;
 : DOES> STATE @ 0= IF DOES>INT ELSE DOES>COMP THEN ;
 IMMEDIATE HEX FE200000 CONSTANT PERI_BASE 1 CONSTANT OUTPUT 0 CONSTANT INPUT : DELAY BEGIN 1 - DUP 0 = UNTIL DROP ;
 : FSEL>ADDRESS A / 4 * PERI_BASE + ;
 : FSEL>VALUE FSEL>ADDRESS @ ;
 : MASK SWAP A MOD 3 * LSHIFT ;
 : BIC INVERT AND ;
 : BIC_MASK 7 MASK ;
 : MSB 4 RSHIFT ;
 : LSB 0F AND ;
 : R@ R> R> TUCK >R >R ;
 : SET_GPFSEL OVER BIC_MASK ROT ROT SWAP DUP ROT MASK SWAP DUP FSEL>VALUE >R ROT R> SWAP BIC ROT OR SWAP FSEL>ADDRESS ! ;
 : SET_CLR_MASK DUP 20 < IF 1 SWAP LSHIFT ELSE DUP 1F > IF 1 SWAP 20 MOD LSHIFT THEN THEN ;
 : SET_HIGHT DUP SET_CLR_MASK SWAP DUP 20 < IF DROP 1C PERI_BASE + ! ELSE DUP 1F > IF DROP 20 PERI_BASE + ! THEN THEN ;
 : SET_LOW DUP SET_CLR_MASK SWAP DUP 20 < IF DROP 28 PERI_BASE + ! ELSE DUP 1F > IF DROP 2C PERI_BASE + ! THEN THEN ;
 HEX FE804000 CONSTANT BSC1 BSC1 CONSTANT CONTROL 4 BSC1 + CONSTANT STATUS 8 BSC1 + CONSTANT DATA_LENGTH 0C BSC1 + CONSTANT SLAVE_ADDRESS 10 BSC1 + CONSTANT DATA_FIFO : CONFIG_I2C_GPIO 2 4 SET_GPFSEL 3 4 SET_GPFSEL ;
 : RESET_STATUS STATUS @ 302 OR STATUS ! ;
 : RESET_FIFO CONTROL @ 10 OR CONTROL ! ;
 : SET_DATA_LENGTH DATA_LENGTH @ 1 OR DATA_LENGTH ! ;
 : SET_SLAVE SLAVE_ADDRESS @ 7F BIC 27 OR SLAVE_ADDRESS ! ;
 : STORE_FIFO DATA_FIFO @ FF BIC OR DATA_FIFO ! ;
 : START_TRANSFER CONTROL @ 1 BIC 8080 OR CONTROL ! ;
 : SEND RESET_STATUS RESET_FIFO SET_DATA_LENGTH SET_SLAVE STORE_FIFO START_TRANSFER ;
 HEX 02 CONSTANT RETURN_HOME 01 CONSTANT CLEAR : OPEN_DOOR 79 80 69 78 32 68 79 79 82 9 ;
 : SEND_WORD >R BEGIN R> 1 - >R SEND_DATA UNTIL R@ 0 > ;
 : SEND_NIBBLE SWAP 4 LSHIFT OR SEND 1000 DELAY ;
 : SEND_COMMAND DUP MSB SWAP LSB SWAP DUP 0C SEND_NIBBLE 08 SEND_NIBBLE DUP 0C SEND_NIBBLE 08 SEND_NIBBLE ;
 : SEND_DATA DUP MSB SWAP LSB SWAP DUP 0D SEND_NIBBLE 09 SEND_NIBBLE DUP 0D SEND_NIBBLE 09 SEND_NIBBLE ;
 : INITIALIZE_LCD CONFIG_I2C_GPIO RETURN_HOME SEND_COMMAND ;
